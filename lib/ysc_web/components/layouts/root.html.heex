<!DOCTYPE html>
<html lang="en" class="[scrollbar-gutter:stable]">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="csrf-token" content={get_csrf_token()} />

    <link rel="manifest" href={~p"/site.webmanifest"} />
    <link rel="preload" as="image" href={~p"/images/tahoe-cabin-feature.jpg"} />

    <.live_title suffix=" · The Young Scandinavians Club">
      <%= assigns[:page_title] || "YSC" %>
    </.live_title>
    <link phx-track-static rel="stylesheet" href={~p"/assets/app.css"} />
    <script defer phx-track-static type="text/javascript" src={~p"/assets/app.js"}>
    </script>

    <script src="https://cdn.jsdelivr.net/npm/add-to-calendar-button@2" async defer>
    </script>
    <link href="https://js.radar.com/v4.4.8/radar.css" rel="stylesheet" />
    <script src="https://js.radar.com/v4.4.8/radar.min.js" defer>
    </script>
    <script src="https://js.stripe.com/v3/" defer>
    </script>
    <script>
      window.stripePublishableKey = "<%= Application.get_env(:stripity_stripe, :public_key) %>";
    </script>
    <Turnstile.script />
  </head>
  <body class="antialiased bg-white">
    <div id="content-wrapper" class="flex flex-col min-h-screen">
      <header :if={!fullscreen?(@conn)}>
        <div id="hero-branding" class="relative overflow-hidden h-44">
          <div
            :if={@current_user && @current_user.role == :admin}
            class="z-50 absolute left-0 top-0 bg-zinc-800 rounded-b px-2 items-center flex py-2"
          >
            <.link
              navigate={~p"/admin"}
              class="text-sm bg-green-700 rounded px-3 py-1.5 transition hover:bg-green-500 items-center font-semibold text-zinc-100"
            >
              <.icon name="hero-cog" class="me-1 -mt-0.5" />Go to admin dashboard
            </.link>
          </div>

          <div class="w-full h-full">
            <div class="w-full h-full overlay">
              <canvas
                id="blur-hash-image-tahoe-feature"
                src="|TD,WZ%MacofWCX9t7oHadNGRijEofRjkEofacWB.At8MwkCaeWYbHjDj=IARPozt7jrWYa#axoeWZt7jrogoej]a$ofjsWBWAt8RjadV@WBofj@t8ofWBkDWAofofkCofoet7RjV@kCWBj@j[f6WCRPj[kCj[j]jsayfR"
                class="absolute inset-0 object-cover w-full h-full will-change-opacity"
                phx-hook="BlurHashCanvas"
              >
              </canvas>
              <img
                class="absolute inset-0 object-cover w-full h-full opacity-0 transition-opacity duration-300 ease-out will-change-opacity"
                id="image-tahoe-feature"
                loading="eager"
                src={~p"/images/tahoe-cabin-feature.jpg"}
                phx-hook="BlurHashImage"
              />
            </div>

            <div class="z-10 absolute max-w-screen-lg w-full transform top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 items-center flex">
              <.link
                navigate={~p"/"}
                class="transition-opacity ease-in-out duration-400 hover:opacity-80 w-full"
              >
                <div class="flex items-center text-left px-4 space-x-5 justify-between">
                  <.ysc_logo class="h-20 md:h-24" />
                  <span class="self-center text-2xl font-extrabold tracking-wide text-white uppercase sm:text-3xl md:text-5xl lg:whitespace-nowrap">
                    The Young Scandinavians Club
                  </span>
                </div>
              </.link>
            </div>
          </div>
        </div>

        <nav id="rootNavbar" class="top-0 z-50 w-full bg-white border-b border-zinc-100 start-0">
          <div class="flex flex-row items-start lg:items-center space-x-10 justify-between max-w-screen-lg p-4 mx-auto">
            <div class="flex w-full items-center">
              <.hamburger_menu toggle_id="navbar-dropdown" current_user={@current_user}>
                <ul class="flex flex-col py-4 mt-2 font-medium lg:p-0 lg:space-x-8 lg:flex-row lg:mt-0 lg:border-0">
                  <li>
                    <.link
                      navigate={~p"/news"}
                      class="block px-3 py-2 font-bold transition ease-in-out rounded text-zinc-900 hover:bg-zinc-100 duration-400 hover:text-black"
                      phx-click={JS.remove_class("expanded", to: "#navbar-dropdown.expanded")}
                    >
                      News
                    </.link>
                  </li>
                  <li>
                    <.link
                      navigate={~p"/events"}
                      class="block px-3 py-2 font-bold transition ease-in-out rounded text-zinc-900 hover:bg-zinc-100 duration-400 hover:text-black"
                      phx-click={JS.remove_class("expanded", to: "#navbar-dropdown.expanded")}
                    >
                      Events
                    </.link>
                  </li>
                  <li>
                    <.link
                      navigate={~p"/bookings/tahoe"}
                      class="block px-3 py-2 font-bold transition ease-in-out rounded text-zinc-900 hover:bg-zinc-100 duration-400 hover:text-black"
                      phx-click={JS.remove_class("expanded", to: "#navbar-dropdown.expanded")}
                    >
                      Tahoe Cabin
                    </.link>
                  </li>
                  <li>
                    <.link
                      navigate={~p"/bookings/clear-lake"}
                      class="block px-3 py-2 font-bold transition ease-in-out rounded text-zinc-900 hover:bg-zinc-100 duration-400 hover:text-black"
                      phx-click={JS.remove_class("expanded", to: "#navbar-dropdown.expanded")}
                    >
                      Clear Lake Cabin
                    </.link>
                  </li>
                  <li>
                    <.dropdown
                      id="about"
                      class="text-zinc-900 hover:bg-zinc-100 hover:text-black"
                      mobile={true}
                    >
                      <:button_block>
                        About
                        <.icon name="hero-chevron-down" class="w-4 h-4 ms-2 text-color-zinc-800" />
                      </:button_block>
                      <ul
                        class="py-2 text-sm font-medium text-zinc-800"
                        aria-labelledby="dropdownLargeButton"
                      >
                        <li>
                          <.link
                            navigate={~p"/contact"}
                            class="block px-4 py-2 transition ease-in-out duration-400 hover:bg-zinc-100"
                            phx-click={
                              JS.remove_class("expanded", to: "#navbar-dropdown.expanded")
                            }
                          >
                            Contact Us
                          </.link>
                        </li>
                        <li>
                          <.link
                            navigate={~p"/volunteer"}
                            class="block px-4 py-2 transition ease-in-out duration-400 hover:bg-zinc-100"
                            phx-click={
                              JS.remove_class("expanded", to: "#navbar-dropdown.expanded")
                            }
                          >
                            Volunteer
                          </.link>
                        </li>
                        <li>
                          <.link
                            navigate={~p"/report-conduct-violation"}
                            class="block px-4 py-2 transition ease-in-out hover:bg-zinc-100 duration-400"
                            phx-click={
                              JS.remove_class("expanded", to: "#navbar-dropdown.expanded")
                            }
                          >
                            Report Conduct Violation
                          </.link>
                        </li>

                        <li>
                          <.link
                            navigate={~p"/history"}
                            class="block px-4 py-2 transition ease-in-out hover:bg-zinc-100 duration-400"
                            phx-click={
                              JS.remove_class("expanded", to: "#navbar-dropdown.expanded")
                            }
                          >
                            History
                          </.link>
                        </li>

                        <li>
                          <.link
                            navigate={~p"/board"}
                            class="block px-4 py-2 transition ease-in-out hover:bg-zinc-100 duration-400"
                            phx-click={
                              JS.remove_class("expanded", to: "#navbar-dropdown.expanded")
                            }
                          >
                            Board of Directors
                          </.link>
                        </li>

                        <li>
                          <.link
                            navigate={~p"/financials"}
                            class="block px-4 py-2 transition ease-in-out hover:bg-zinc-100 duration-400"
                            phx-click={
                              JS.remove_class("expanded", to: "#navbar-dropdown.expanded")
                            }
                          >
                            Financials & Annual Meetings
                          </.link>
                        </li>

                        <li>
                          <.link
                            navigate={~p"/bylaws"}
                            class="block px-4 py-2 transition ease-in-out hover:bg-zinc-100 duration-400"
                            phx-click={
                              JS.remove_class("expanded", to: "#navbar-dropdown.expanded")
                            }
                          >
                            Bylaws
                          </.link>
                        </li>

                        <li>
                          <.link
                            navigate={~p"/code-of-conduct"}
                            class="block px-4 py-2 transition ease-in-out hover:bg-zinc-100 duration-400"
                            phx-click={
                              JS.remove_class("expanded", to: "#navbar-dropdown.expanded")
                            }
                          >
                            Non-Discrimination Code of Conduct
                          </.link>
                        </li>
                      </ul>
                    </.dropdown>
                  </li>
                </ul>

                <:cta_section>
                  <%= if @current_user do %>
                    <.user_avatar
                      email={@current_user.email}
                      user_id={@current_user.id}
                      most_connected_country={@current_user.most_connected_country}
                      first_name={String.capitalize(@current_user.first_name)}
                      last_name={String.capitalize(@current_user.last_name)}
                    >
                      <div class="z-10 w-64 bg-white divide-y divide-zinc-100 rounded shadow">
                        <div class="px-4 py-3 text-sm text-zinc-900">
                          <p>
                            <%= String.capitalize(@current_user.first_name) <>
                              " " <> String.capitalize(@current_user.last_name) %>
                          </p>
                          <div class="font-medium truncate"><%= @current_user.email %></div>
                        </div>
                        <ul class="py-2 text-sm text-zinc-700" aria-labelledby="avatarButton">
                          <li>
                            <.link
                              navigate={~p"/users/membership"}
                              class="block px-4 py-2 transition ease-in-out hover:bg-zinc-100 duration-400"
                            >
                              Membership
                            </.link>
                          </li>
                          <li>
                            <.link
                              navigate={~p"/users/payments"}
                              class="block px-4 py-2 transition ease-in-out hover:bg-zinc-100 duration-400"
                            >
                              My Bookings & Tickets
                            </.link>
                          </li>
                          <li>
                            <.link
                              navigate={~p"/users/settings"}
                              class="block px-4 py-2 transition ease-in-out hover:bg-zinc-100 duration-400"
                            >
                              Account Settings
                            </.link>
                          </li>
                        </ul>
                        <div class="py-1">
                          <.link
                            href={~p"/users/log-out"}
                            method="delete"
                            class="block px-4 py-2 text-sm text-zinc-800 transition ease-in-out hover:bg-zinc-100 duration-400"
                          >
                            Sign out
                          </.link>
                        </div>
                      </div>
                    </.user_avatar>
                  <% else %>
                    <div class="flex items-center space-x-2">
                      <.link
                        href={~p"/users/log-in"}
                        class="px-2 py-2 lg:px-3 lg:py-2 font-bold transition ease-in-out rounded text-zinc-900 hover:bg-zinc-100 duration-400 hover:text-black"
                      >
                        Sign In
                      </.link>
                      <.link
                        navigate={~p"/users/register"}
                        class="px-3 py-2 lg:px-4 lg:py-2.5 text-sm font-bold text-center text-zinc-100 transition ease-in-out bg-blue-700 rounded duration-400 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300"
                      >
                        Become a Member
                      </.link>
                    </div>
                  <% end %>
                </:cta_section>
              </.hamburger_menu>
            </div>
          </div>
        </nav>
      </header>
      <!-- Pending approval flash message -->
      <div
        :if={@current_user && @current_user.state == :pending_approval}
        class="bg-yellow-50 border-l-4 border-yellow-400 p-4"
      >
        <div class="flex items-center max-w-screen-lg mx-auto md:px-4">
          <div class="flex-shrink-0">
            <.icon name="hero-exclamation-triangle" class="h-8 w-8 text-yellow-400" />
          </div>
          <div class="px-4">
            <p class="text-sm text-yellow-700">
              <strong>Application Under Review:</strong>
              Your membership application is currently being reviewed by our board. You will be able to access all features of the website once your application has been approved. For more details <.link
                navigate={~p"/pending-review"}
                class="text-yellow-700 hover:underline font-bold"
              >click here</.link>.
            </p>
          </div>
        </div>
      </div>
      <!-- Inactive membership banner -->
      <div
        :if={@current_user && @current_user.state == :active && !@active_membership?}
        class="bg-orange-50 border-l-4 border-orange-400 p-4"
      >
        <div class="flex items-center max-w-screen-lg mx-auto md:px-4">
          <div class="flex-shrink-0">
            <.icon name="hero-exclamation-triangle" class="h-8 w-8 text-orange-400" />
          </div>
          <div class="px-4 flex-1">
            <p class="text-sm text-orange-700 mb-3">
              <strong>Membership Required:</strong>
              To access events and the cabin booking system, you need a paying member of the club. Click the button below to activate your membership plan.
            </p>
            <div class="flex flex-col sm:flex-row gap-2">
              <.link
                navigate={~p"/users/membership"}
                class="inline-flex items-center px-4 py-2 text-sm font-semibold text-white bg-orange-600 rounded-md hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 transition-colors duration-200"
              >
                <.icon name="hero-credit-card" class="w-5 h-5 me-2" /> Manage Membership
              </.link>
            </div>
          </div>
        </div>
      </div>

      <main class="flex-1 w-full">
        <%= @inner_content %>
      </main>

      <footer :if={!fullscreen?(@conn)} class="bg-white border-t border-zinc-100 w-full">
        <div class="max-w-screen-lg p-4 py-6 mx-auto lg:py-8">
          <div class="lg:flex lg:justify-between">
            <div class="mb-6 lg:mb-0">
              <.link navigate={~p"/"} class="flex items-center">
                <.ysc_logo class="h-14 me-3" />
                <span class="self-center text-xl font-semibold whitespace-nowrap">
                  The Young Scandinavians Club
                </span>
              </.link>
            </div>
            <div class="flex mb-6">
              <div>
                <h2 class="mb-2 text-sm font-semibold uppercase text-zinc-900">
                  Follow us on socials
                </h2>
                <ul class="flex flex-wrap items-start justify-start">
                  <li class="">
                    <a href={@site_setting_socials_facebook} target="_blank">
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        x="0px"
                        y="0px"
                        viewBox="0 0 64 64"
                        class="w-10 h-10 transition duration-300 fill-current text-zinc-900 hover:text-blue-700"
                      >
                        <path d="M48,7H16c-4.418,0-8,3.582-8,8v32c0,4.418,3.582,8,8,8h17V38h-6v-7h6v-5c0-7,4-11,10-11c3.133,0,5,1,5,1v6h-4 c-2.86,0-4,2.093-4,4v5h7l-1,7h-6v17h8c4.418,0,8-3.582,8-8V15C56,10.582,52.418,7,48,7z">
                        </path>
                      </svg>
                    </a>
                  </li>
                  <li>
                    <a href={@site_setting_socials_instagram} target="_blank">
                      <div class="relative">
                        <svg
                          style="width:0;height:0;position:absolute;"
                          aria-hidden="true"
                          focusable="false"
                        >
                          <linearGradient id="insta-gradient" y1="1">
                            <stop stop-color="#405de6" />
                            <stop offset=".2" stop-color="#5851db" />
                            <stop offset=".4" stop-color="#833ab4" />
                            <stop offset=".6" stop-color="#c13584" />
                            <stop offset=".8" stop-color="#e1306c" />
                            <stop offset="1" stop-color="#fd1d1d" />
                          </linearGradient>
                        </svg>
                        <svg
                          xmlns="http://www.w3.org/2000/svg"
                          x="0px"
                          y="0px"
                          viewBox="0 0 64 64"
                          class="absolute z-10 w-10 h-10 transition duration-300 fill-current text-zinc-900 hover:opacity-0"
                        >
                          <path d="M 21.580078 7 C 13.541078 7 7 13.544938 7 21.585938 L 7 42.417969 C 7 50.457969 13.544938 57 21.585938 57 L 42.417969 57 C 50.457969 57 57 50.455062 57 42.414062 L 57 21.580078 C 57 13.541078 50.455062 7 42.414062 7 L 21.580078 7 z M 47 15 C 48.104 15 49 15.896 49 17 C 49 18.104 48.104 19 47 19 C 45.896 19 45 18.104 45 17 C 45 15.896 45.896 15 47 15 z M 32 19 C 39.17 19 45 24.83 45 32 C 45 39.17 39.169 45 32 45 C 24.83 45 19 39.169 19 32 C 19 24.831 24.83 19 32 19 z M 32 23 C 27.029 23 23 27.029 23 32 C 23 36.971 27.029 41 32 41 C 36.971 41 41 36.971 41 32 C 41 27.029 36.971 23 32 23 z">
                          </path>
                        </svg>
                        <svg
                          fill="url(#insta-gradient)"
                          xmlns="http://www.w3.org/2000/svg"
                          x="0px"
                          y="0px"
                          viewBox="0 0 64 64"
                          class="absolute w-10 h-10 transition duration-300 z-1"
                        >
                          <path d="M 21.580078 7 C 13.541078 7 7 13.544938 7 21.585938 L 7 42.417969 C 7 50.457969 13.544938 57 21.585938 57 L 42.417969 57 C 50.457969 57 57 50.455062 57 42.414062 L 57 21.580078 C 57 13.541078 50.455062 7 42.414062 7 L 21.580078 7 z M 47 15 C 48.104 15 49 15.896 49 17 C 49 18.104 48.104 19 47 19 C 45.896 19 45 18.104 45 17 C 45 15.896 45.896 15 47 15 z M 32 19 C 39.17 19 45 24.83 45 32 C 45 39.17 39.169 45 32 45 C 24.83 45 19 39.169 19 32 C 19 24.831 24.83 19 32 19 z M 32 23 C 27.029 23 23 27.029 23 32 C 23 36.971 27.029 41 32 41 C 36.971 41 41 36.971 41 32 C 41 27.029 36.971 23 32 23 z">
                          </path>
                        </svg>
                      </div>
                    </a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="sm:flex sm:items-center sm:justify-between">
            <span class="text-sm text-zinc-600 sm:text-center">
              © <%= DateTime.utc_now().year %> <.link href={~p"/"} class="hover:underline">The Young Scandinavians Club</.link>. All Rights Reserved.
            </span>
            <span class="text-sm text-zinc-500 sm:text-center">
              <.link navigate={~p"/privacy-policy"} class="hover:underline">Privacy Policy</.link>
            </span>
          </div>
        </div>
      </footer>
    </div>
  </body>
</html>
